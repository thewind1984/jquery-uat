!function(t){t.fn.uat=function(e){function i(){return console.clear(),o.call(this),t.fn.uat.view.call(this),n.call(this),s.call(this),this}function n(){if(!t.fn.uat.instance.call(this)){var i=this;t(e.obj).on("uatqueue",function(){l.call(i)})}}function o(){t.fn.uat.storage.call(this,"set","settings",e)}function s(){var e=t.fn.uat.storage.call(this,"get","tests");if("undefined"!=typeof e&&null!==e&&e.length){t.fn.uat.instance.call(this,"set"),h=e;for(var i=0;h[i].passed;){var n=h[i];g!==n.page&&(t.fn.uat.log.call(this,null,"--- page",n.page),g=n.page),t.fn.uat.log.call(this,n.result.type,n.name+" test: "+t.fn.uat.args.call(this,n.args),n.result.result),i++}this.run()}}function a(t,e){return r.call(this,"unit",t,e)}function u(t,e){return r.call(this,"step",t,e)}function r(e,i,n){return t.fn.uat.instance.call(this)?(console.log("skip adding "+e+" ("+i+")"),this):(h.push({type:e,name:i,args:n||[],passed:0,date:null,result:null,page:p}),this)}function l(){var e=t.fn.uat.storage.call(this,"get","testNum")||0;if(e>=h.length)return resultation.call(this);var i=h[e];if(m||(t.fn.uat.log.call(this,null,"--- page",i.page),m=new Date),"undefined"==typeof i.page||i.page!==f)return this;i.date=new Date;var n=t.fn.uat[i.type].call(this,i.name,i.args);if("string"!=typeof n)this.run();else switch(n){case"stop":}}var c="console";e="object"==typeof e?e:{},e=t.extend({},{obj:null,step_by_step:!1,break_on_error:!1,timeout:0,output:c,debug:!1},e,{obj:this}),e.timeout=!isNaN(parseFloat(e.timeout))&&parseFloat(e.timeout)>0?parseFloat(e.timeout):0,e.output=-1==t.inArray(e.output,["console","window"])?c:e.output;var h=[],d=!1,f=location.href,p=f,g=null,m=!1,w=parseFloat(t("body").css("margin-bottom")),b=[];return sleep=function(t){var e=new Date,i=null;do i=new Date;while(t>i-e)},testFinished=function(i,n){"unit"==i&&(d!==!1&&t.fn.uat.log.call(this,"info","break branch to root",!0),d=!1);var o=t.fn.uat.storage.call(this,"get","testNum");return h[o].result=n,h[o].passed=1,t.fn.uat.storage.call(this,"set","tests",h),t.fn.uat.storage.call(this,"set","testNum",o+1),e.timeout&&(t.fn.uat.log.call(this,null,"--- timeout",e.timeout+"sec"),sleep(1e3*e.timeout)),n.action||this},resultation=function(){var e={};t(h).each(function(){1==this.passed&&("undefined"==typeof e[this.result.type]&&(e[this.result.type]=0),e[this.result.type]++)});var i=[];return t.each(e,function(t,e){i.push(t+": "+e)}),t.fn.uat.log.call(this,null,"--- tests finished",i.join(", ")),t.fn.uat.storage.call(this,"set","tests",null),t.fn.uat.storage.call(this,"set","settings",{}),t.fn.uat.storage.call(this,"set","testNum",0),t.fn.uat.instance.call(this,"del"),this},getLastFoundObj=function(){return d},setLastFoundObj=function(t){d=t},getSettings=function(){return e},getBodyMarginBottom=function(){return w},addLogScope=function(t){b.push(t)},getLogScope=function(){return b},this.contains=function(t){return a.call(this,"contains",[t])},this.notContains=function(t){return a.call(this,"notContains",[t])},this.hasCookie=function(t){return a.call(this,"hasCookie",[t])},this.isObjVisible=function(t){return a.call(this,"isObjVisible",[t])},this.hasJsVariable=function(t){return a.call(this,"hasJsVariable",[t])},this.valueEqualsTo=function(t,e){return a.call(this,"valueEqualsTo",[t,e])},this.findObj=function(t){return u.call(this,"findObj",[t])},this.setCookie=function(t,e){return u.call(this,"setCookie",[t,e])},this.removeCookie=function(t){return u.call(this,"removeCookie",[t])},this.redirectTo=function(e){if(e=t.trim(e),e!==p){var i=u.call(this,"redirectTo",[e]);return p=e,i}},this.clickBy=function(t){return u.call(this,"clickBy",[t])},this.wait=function(t){return u.call(this,"wait",[t])},this.waitFor=function(){},this.fillIn=function(){},this.scrollToObj=function(t,e){return u.call(this,"scrollToObj",[t,e])},this.finish=function(){return t.fn.uat.instance.call(this)?this:(t.fn.uat.storage.call(this,"set","tests",h),void this.run())},this.run=function(){setTimeout(function(){t(e.obj).trigger("uatqueue")},m?1e3*e.timeout:50)},i.call(this)},t.fn.uat.args=function(e){var i=[];return t(e).each(function(){i.push(this.toString())}),i.join(", ")},t.fn.uat.unit=function(e,i){var n=t.fn.uat.unit[e].apply(this,i);return t.fn.uat.log.call(this,n.type,e+" test: "+t.fn.uat.args.call(this,i),n.result),testFinished.call(this,"unit",n)},t.fn.uat.unit.contains=function(e){var i=(getLastFoundObj()||t(getSettings().obj)).find(e).length?!0:!1;return{type:i?"success":"error",result:i}},t.fn.uat.unit.notContains=function(e){var i=(getLastFoundObj()||t(getSettings().obj)).find(e).length?!1:!0;return{type:i?"success":"error",result:i}},t.fn.uat.unit.hasCookie=function(t){var e=new RegExp("(^|; )"+t.toString()+"=([^;$]*)","gi").exec(document.cookie);return{type:null!=e?"success":"error",result:null!=e?""!==e[2]?e[2]:"[EMPTY VALUE]":!1}},t.fn.uat.unit.isObjVisible=function(e){var i=t(e),n=i.offset().top,o=i.outerHeight(),s=n+o,a=t(window).outerHeight()+t(window).scrollTop(),u=a>n,r=u?a>=s?100:(o-(s-a))/o*100:0;return{type:u?"success":"error",result:(u?"true":"false")+" ("+r+"%)"}},t.fn.uat.unit.hasJsVariable=function(t){var e="undefined"!=typeof window[t];return{type:e?"success":"error",result:e?window[t].toString():!1}},t.fn.uat.unit.valueEqualsTo=function(e,i){var n=t(e);if(n.length){var o=n.attr("name")||null,s=o?t('[name="'+o+'"]'):[],a=o?s.length>1:!1,u=a?s:n,r=[];t(u).each(function(){var e=this.tagName.toLowerCase(),i=t(this).attr("type")||null;switch(e){case"input":-1!=t.inArray(i,["checkbox","radio"])?t(t(this).filter(":selected")).each(function(){r.push(this.value)}):r.push(this.value);case"button":case"textarea":r.push(this.value);break;case"select":t(t(this).find("option:selected")).each(function(){r.push(this.value)})}});var l=-1!=t.inArray(i,r);return{type:l?"success":"error",result:l}}return{type:"error",result:"object not found"}},t.fn.uat.step=function(e,i){var n=t.fn.uat.unit[e].apply(this,i);return t.fn.uat.log.call(this,n.type,e+" test: "+t.fn.uat.args.call(this,i),n.result),testFinished.call(this,"step",n)},t.fn.uat.unit.findObj=function(e){return setLastFoundObj(t(getSettings().obj).find(e)),getLastFoundObj().length?{type:"success",result:!0}:{type:"warning",result:!1}},t.fn.uat.unit.setCookie=function(t,e){return document.cookie=t+"="+e.toString(),{type:"success",result:!0}},t.fn.uat.unit.removeCookie=function(t){return document.cookie=t+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;",{type:"success",result:!0}},t.fn.uat.unit.scrollToObj=function(e,i){return t("html,body").scrollTop(t(e).offset().top+parseInt(i||0)),{type:"success",result:"scrollTop: "+t(window).scrollTop()}},t.fn.uat.unit.clickBy=function(e){return t(e).trigger("click"),{type:"success",result:!0}},t.fn.uat.unit.wait=function(t){return sleep.call(this,t),{type:"success",result:!0}},t.fn.uat.unit.redirectTo=function(t){return location.href=t,{type:"success",result:!0,action:"stop"}},t.fn.uat.view=function(e,i){function n(){var e=t(l.window);e.css({bottom:"auto",top:e.position().top+"px"}),s.call(this),e.data({offset:e.position(),width:e.outerWidth(),height:e.outerHeight()})}function o(){t(l.window).css(d),n.call(this),t.fn.uat.storage.call(this,"set","window",null)}function s(){var e=t(l.window),i=e.position(),n=document.body.clientWidth-e.outerWidth(),o=document.body.clientHeight-e.outerHeight();i.left<0?e.css("left",0):i.left>n&&e.css("left",n),i.top<0?e.css("top",0):i.top>o&&e.css("top",o)}function a(){var e=t(l.window);t.fn.uat.storage.call(this,"set","window.position.left",e.data("offset").left+"px"),t.fn.uat.storage.call(this,"set","window.position.top",e.data("offset").top+"px"),t.fn.uat.storage.call(this,"set","window.dimension.width",e.data("width")+"px"),t.fn.uat.storage.call(this,"set","window.dimension.height",e.data("height")+"px")}function u(){if(t(l.window).length){var e=t(l.window);e.toggle()}else{var i={"-moz-user-select":"-moz-none","-khtml-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none"},o={border:"1px solid #333",borderRadius:"4px",padding:"10px"},s={display:"flex",flexDirection:"row"},a={flexDirection:"column"},u={overflow:"auto",overflowX:"inherit"},r=t.fn.uat.storage.call(this,"get","window.position.left"),h=t.fn.uat.storage.call(this,"get","window.position.top"),f=t.fn.uat.storage.call(this,"get","window.dimension.width"),p=t.fn.uat.storage.call(this,"get","window.dimension.height"),e=t("<div>").attr({id:l.window.replace("#","")}).css(t.extend({},i,s,{position:"fixed",left:r||d.left,width:f||d.width,height:p||d.height,background:"#f1f1f1",color:"#000",fontSize:"12px",fontFamily:"Arial",fontWeight:"normal",fontStyle:"normal",padding:"10px",paddingTop:"16px",margin:0,boxSizing:"border-box",border:"2px solid #bbb",borderRadius:"6px",justifyContent:"space-between",opacity:c,minHeight:"100px",minWidth:"522px",transition:"opacity .3s"})).css("undefined"==typeof h?"bottom":"top",h||d.bottom).appendTo("body");n.call(this);{var g=(t("<div>").attr({id:l.mouseMover.replace("#",""),title:"Move UAT window by moving this bar","data-obj":"mover"}).css(t.extend({},o,{padding:0,position:"absolute",left:"2px",top:"2px",width:"calc(100% - 4px)",height:"0",borderWidth:"3px",background:"#333",cursor:"move"})).appendTo(e),t("<div>").attr({id:l.mouseResizer.replace("#",""),title:"Resize UAT window by moving this corner","data-obj":"resizer"}).css(t.extend({},o,{padding:0,position:"absolute",bottom:"2px",right:"2px",width:"20px",height:"20px",border:"3px solid #333",borderTop:0,borderLeft:0,cursor:"se-resize"})).appendTo(e),t("<div>").attr({id:l.tests.replace("#","")}).css(t.extend({},s,a,{width:"100%",marginRight:"10px"})).appendTo(e));t("<div>").attr({id:l.result.replace("#","")}).css(t.extend({},o,{height:"100%"},u)).appendTo(g),t("<div>").attr({id:l.help.replace("#","")}).css(t.extend({},o,{width:"100%",maxWidth:"300px"},u)).append('<div style="margin-bottom:10px;"><div style="float:right;"><b>Ctrl + Alt + U</b></div><div>Show / hide UAT window</div><div style="font-size:11px;margin-top:4px;">If init option <i>output</i> equals to <i>window</i>, it will be showen automatically.<div></div>').append('<div style="margin-bottom:10px;"><div style="float:right;"><b>Ctrl + Alt + R</b></div><div>Restore UAT window to initial state</div><div style="font-size:11px;margin-top:4px;">Full width, sticked to bottom of the window</div></div>').appendTo(e)}this.showResults("window")}}function r(){t("body").on("mouseover touchstart",l.window,function(){t(this).css("opacity",1)}).on("mouseout touchend",l.window,function(){t(this).css("opacity",c)}),t("body").on("mousedown touchstart",l.mouseMover+","+l.mouseResizer,function(e){h.mouseIsDown=!0,h.mouseObj=t(this),h.mousePosition.x="mousedown"==e.type?e.clientX:e.touches[0].clientX,h.mousePosition.y="mousedown"==e.type?e.clientY:e.touches[0].clientY,t(this).data("border",t(this).css("border-color")),t(this).css("border-color","red")}),t(window).on("keydown",function(t){if(t.ctrlKey&&t.altKey)switch(t.keyCode){case 85:u.call(h);break;case 82:o.call(h)}}).on("resize",function(){s(),n(),a()}).on("mouseup touchend",function(){h.mouseIsDown=!1,null!==h.mouseObj&&h.mouseObj.css("border-color",h.mouseObj.data("border"))}).on("mousemove touchmove",function(e){if(h.mouseIsDown){var i="mousemove"==e.type?e.clientX:e.changedTouches[0].clientX,n="mousemove"==e.type?e.clientY:e.changedTouches[0].clientY,o={x:i-h.mousePosition.x,y:n-h.mousePosition.y};h.mousePosition.x=i,h.mousePosition.y=n;var s=t(l.window);switch(h.mouseObj.data("obj")){case"mover":var u=s.data("offset").left+o.x,r=s.data("offset").top+o.y;if(0>u||u>document.body.clientWidth-s.outerWidth()||0>r||r>document.body.clientHeight-s.outerHeight())break;s.data("offset",{left:u,top:r}),s.css({left:s.data("offset").left+"px",top:s.data("offset").top+"px"});break;case"resizer":s.data({width:s.data("width")+o.x,height:s.data("height")+o.y}),s.css({width:s.data("width")+"px",height:s.data("height")+"px"})}a()}})}var l={window:"#uat_window",tests:"#uat_block",help:"#uat_help",create:"#uat_create",result:"#uat_result",mouseMover:"#uat_mouse_mover",mouseResizer:"#uat_mouse_resize"},c=.3,h=this,d={width:"calc(100% - 20px)",height:"300px",left:"10px",top:"auto",bottom:"5px"};this.mouseIsDown=!1,this.mouseObj=null,this.mousePosition={x:0,y:0},this.showResults=function(e){t.fn.uat.log.call(this,e)},this.addLine=function(e,i,n){var o="uat_result_item_"+1e5*Math.random(),s=t(l.result);t("<div>").attr({style:n,id:o}).html(e+": "+i).appendTo(s),s.animate({scrollTop:s.prop("scrollHeight")},500)},this.init=function(){"window"===getSettings().output&&u.call(this),r()},this[e||"init"].apply(this,i||[])},t.fn.uat.log=function(e,i,n){function o(t,e,i){addLogScope([t,e,i]),s.call(this,t,e,i,getSettings().output)}function s(e,i,n,o){var s="color:"+n;i="undefined"==typeof i?"":i,"console"==o?console.log("%c"+e,s,i):t.fn.uat.view.call(this,"addLine",[e,i,s])}function a(t){for(var e=getLogScope(),i=0;i<e.length;i++){var n=e[i];n.push(t),s.apply(this,n)}}var u="black";switch(e){case"error":u="red";break;case"success":u="green";break;case"warning":u="orange";break;case"info":u="blue"}switch(e){case"window":case"console":a.call(this,e);break;default:o.call(this,("undefined"!=typeof e&&null!=e?"["+(new Date).toLocaleString()+"] ["+e.toUpperCase()+"] ":"")+i,n,u)}},t.fn.uat.storage=function(){var e={window:{position:{left:0,top:0},dimension:{width:0,height:0}},settings:{},tests:[],testNum:0},i="uat_object";return this.set=function(i,n){var o=this.object()||e,s=this.prepareObjFromKey(i,n);this.object(t.extend(!0,{},o,s))},this.get=function(t){var e=this.object()||{};for(t=t.split(".");_key=t.shift();){if("undefined"==typeof e[_key]||null===e[_key])return;e=e[_key]}return e},this.object=function(t){if("undefined"==typeof t){var e=localStorage.getItem(i);return"undefined"==typeof e?e:JSON.parse(e)}localStorage.setItem(i,JSON.stringify(t))},this.prepareObjFromKey=function(t,e){t=t.split(".");for(var i=t.pop(),n=tempObj={};_key=t.shift();)tempObj=tempObj[_key]={};return tempObj[i]=e,n},"undefined"!=typeof arguments&&arguments.length?this[arguments[0]].apply(this,Array.from(arguments).slice(1)):void 0},t.fn.uat.instance=function(e){this.check=function(){return"undefined"!=typeof t(document).data("uat")},this.set=function(){t(document).data("uat",!0)},this.del=function(){t(document).removeData("uat")},this[e||"check"].call(this)},t(document).ready(function(){var e=t.fn.uat.storage.call(this,"get","tests");if("undefined"!=typeof e&&null!==e&&e.length){{var i=t.fn.uat.storage.call(this,"get","settings");i.obj}t.each(i,function(t){"obj"===t&&delete i[t]}),t(document).uat(i)}})}(jQuery);